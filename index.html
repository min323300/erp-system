<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>대시보드 - 거래명세 관리 시스템</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <nav class="navbar">
            <div class="nav-brand">
                <a href="index.html">거래명세 관리 시스템</a>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html" class="active">대시보드</a></li>
                <li><a href="sales.html">판매</a></li>
                <li><a href="payment.html">입금</a></li>
                <li><a href="purchase.html">입고</a></li>
                <li><a href="supplypayment.html">지급</a></li>
                <li><a href="inventory.html">재고</a></li>
                <li><a href="accounting.html">회계</a></li>
                <li><a href="settings.html">설정</a></li>
            </ul>
        </nav>

        <main class="main-content">
            <div class="page-header">
                <h1 class="page-title">대시보드</h1>
            </div>

            <div class="dashboard-grid">
                <div class="card stat-card">
                    <div class="stat-icon" style="background: #e3f2fd;">📊</div>
                    <div class="stat-content">
                        <div class="stat-label">이번 달 매출</div>
                        <div class="stat-value" id="monthly-sales">0원</div>
                    </div>
                </div>

                <div class="card stat-card">
                    <div class="stat-icon" style="background: #f3e5f5;">💰</div>
                    <div class="stat-content">
                        <div class="stat-label">이번 달 이익</div>
                        <div class="stat-value" id="monthly-profit">0원</div>
                    </div>
                </div>

                <div class="card stat-card">
                    <div class="stat-icon" style="background: #fff3e0;">⚠️</div>
                    <div class="stat-content">
                        <div class="stat-label">총 미수금</div>
                        <div class="stat-value text-danger" id="total-receivables">0원</div>
                    </div>
                </div>

                <div class="card stat-card">
                    <div class="stat-icon" style="background: #ffebee;">📦</div>
                    <div class="stat-content">
                        <div class="stat-label">재고 부족 품목</div>
                        <div class="stat-value" id="low-stock">0개</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>빠른 시작</h2>
                <div class="quick-actions">
                    <a href="sales.html" class="btn btn-primary">📊 판매 등록</a>
                    <a href="payment.html" class="btn btn-primary">💰 입금 처리</a>
                    <a href="purchase.html" class="btn btn-secondary">📥 입고 등록</a>
                    <a href="settings.html" class="btn btn-secondary">⚙️ 업체 관리</a>
                    <a href="settings.html" class="btn btn-secondary">🏷️ 품목 관리</a>
                </div>
            </div>
        </main>
    </div>

    <script src="api.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            await loadDashboard();
        });

        async function loadDashboard() {
            try {
                const result = await getDashboard();
                if (result.success) {
                    document.getElementById('monthly-sales').textContent = formatCurrency(result.data.monthlySales);
                    document.getElementById('monthly-profit').textContent = formatCurrency(result.data.monthlyProfit);
                    document.getElementById('total-receivables').textContent = formatCurrency(result.data.totalReceivables);
                    document.getElementById('low-stock').textContent = result.data.lowStockItems + '개';

                    // 미수금 있으면 빨간색
                    if (result.data.totalReceivables > 0) {
                        document.getElementById('total-receivables').style.color = '#d32f2f';
                    }
                }
            } catch (error) {
                console.error('대시보드 로드 실패:', error);
            }
        }
    </script>
</body>
</html>
